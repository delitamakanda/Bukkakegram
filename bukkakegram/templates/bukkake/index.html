{% extends 'base.html' %}
{% load cloudinary %}
{% block content %}

<section class="jumbotron text-center">
  <div class="container">
    <h1 class="jumbotron-heading">Bukkakegram</h1>
    <p class="lead text-muted">Share your selfies with our community and make the web great again !</p>
    <p>
      <a href="{% url 'register' %}" class="btn btn-primary">Sign up now !</a>
      <a href="{% url 'flatpage' url='about/' %}" class="btn btn-secondary">Read more</a>
      {% if user.is_authenticated %}
      <a href="{% url 'add_bukkake' %}" class="btn btn-success">Add a bukkake</a>
      {% endif %}
    </p>
  </div>
</section>

<div class="album text-muted">
  <div class="container">


<div class="row bukkake">

  {% for bukkake in bukkakes %}
  <div class="card infinite-item">
    <a href="/{{bukkake.id}}/">
        {% cloudinary bukkake.image width=356 height=280 crop="fill" %}

      {% if bukkake.description %}
      <p class="card-text">
          {{bukkake.description}}
      </p>
      {% endif %}

      <button id="likes" data-id="{{bukkake.id}}" class="btn btn-sm btn-danger glyphicon glyphicon-heart button-like" type="button">
          {% if bukkake.likes > 0 %}
          {{ bukkake.likes }} likes
          {% endif %}
      </button>
    </a>
  </div>
  {% if forloop.counter|divisibleby:3 %}
  </div><div class="row bukkake infinite-container">
  {% endif %}
  {% endfor %}

</div>

{% if bukkakes.has_next %}
    <div class="text-center">

        <a class="btn infinite-more-link" href="?page={{ bukkakes.next_page_number }}">More</a>

    </div>
{% endif %}

<div class="loading" style="display: none;">Loading...</div>


<script>
   $(document).ready(function() {
       var infinite = new Waypoint.Infinite({
         element: $('.infinite-container')[0],
         onBeforePageLoad: function () {
           $('.loading').show();
         },
         onAfterPageLoad: function ($items) {
           $('.loading').hide();
         }
       });
   });
 </script>


</div>
</div>

{% endblock %}
