{% extends "base.html" %}

{% block title %}{{ object.title }}{% endblock %}

{% block content %}
<div class="page dashboard-page">
    <div class="page-title">
        <h3><a href="{{ object.url }}" target="_blank">{{ object.title }}</a></h3>
    </div>
    <div class="page-content">
        <p>Author : {{ object.submitter.username }}</p>
        <p>Created on : {{ object.submitted }}</p>

        <p>
            <h4>New Comment</h4>
            <form action="{% url 'new-comment' %}?link_pk={{ object.pk }}" method="post">
                {% csrf_token %}
                {{ comment_form.as_p }}
                <input type="submit" value="Comment" class="btn" />
            </form>
        </p>

        <p>Comments</p>
        <ul>
            {% for comment in comments %}
            <li>
                {{ comment.body }}
                by {{ comment.commented_by.username }}
                at {{ comment.created_on }}
                <a href="{% url 'new-reply' %}?link_pk={{ object.pk }}&parent_comment_pk={{ comment.pk}}">Reply</a>
                {% if comment.comment_set.exists %}
                <ul>
                    {% for reply in comment.comment_set.all %}
                    <li>
                        {{ reply.body }}
                        by {{ reply.commented_by.username }}
                        at {{ reply.created_on }}
                    </li>
                    {% endfor %}
                </ul>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>

</div>
{% endblock %}
